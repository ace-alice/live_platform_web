<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <!-- ✅ 关键：修复 iOS 缩放问题 -->
  <meta name="viewport"
    content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
  <!-- <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" /> -->

  <!-- web app -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <!-- 推荐保留：现代标准 -->
  <meta name="mobile-web-app-capable" content="yes">

  <meta name="apple-mobile-web-app-status-bar-style" content="dark-content" />
  <meta name="format-detection" content="telephone=no" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />

  <link rel="apple-touch-icon-precomposed" href="/ios/180.png" />
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/ios/180.png" />

  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/ios/57.png" />
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/ios/72.png" />
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/ios/114.png" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/ios/144.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="/ios/114.png" />
  <!--适用于 Retina 屏的 iPad-->
  <link rel="apple-touch-icon" sizes="144x144" href="/pios/144.png" />
  <!--适用于 Retina 屏的 iPhone-->
  <link rel="apple-touch-icon" sizes="120x120" href="/ios/120.png" />
  <!--适用于非 Retina 屏的 iPad-->
  <link rel="apple-touch-icon" sizes="72x72" href="/ios/72.png" />
  <!--适用于非 Retina 屏的 iPhone-->
  <link rel="apple-touch-icon" sizes="57x57" href="/ios/57.png" />

  <link rel="apple-touch-icon" sizes="152x152" href="/ios/152.png" />

  <link rel="apple-touch-icon" sizes="60x60" href="/ios/60.png" />

  <link rel="apple-touch-icon" sizes="180x180" href="/ios/180.png" />

  <link rel="apple-touch-icon" href="/ios/180.png" />

  <!-- theme color-->
  <meta name="theme-color" content="#000000" />

  <!--suppress HtmlUnknownTarget -->
  <link id="favicon" rel="icon" href="/ios/60.png" />
  <title>
    <%= title %>
  </title>

  <!-- ===== 核心修复 CSS ===== -->
  <style>
    html,
    body {
      /* 防止 iOS 双击缩放 */
      touch-action: manipulation;

      /* 防止文字自动放大 */
      -webkit-text-size-adjust: 100%;
    }

    input,
    textarea {
      font-size: 16px !important;
      touch-action: manipulation;
    }
  </style>

  <!-- ===== 核心修复 JS（终极关键）===== -->
  <script>
    (function () {
      let lastTouchEnd = 0;

      document.addEventListener('touchend', function (event) {
        const now = Date.now();
        if (now - lastTouchEnd <= 300) {
          event.preventDefault();
        }
        lastTouchEnd = now;
      }, { passive: false });

      document.addEventListener('gesturestart', function (e) {
        e.preventDefault();
      });
    })();
  </script>
</head>

<body class="body-bg">
  <!--suppress JSUnresolvedVariable -->

  <noscript>
    <strong>We're sorry but doesn't work properly without JavaScript enabled.
      Please enable it to
      continue.</strong>
  </noscript>
  <div id="app" class="app"></div>
  <script type="module" src="/src/main.ts"></script>
</body>

</html>